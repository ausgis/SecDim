[{"path":"https://ausgis.github.io/SecDim/articles/SecDim.html","id":"introduction-to-secdim-package","dir":"Articles","previous_headings":"","what":"Introduction to SecDim package","title":"`SecDim` Package for The Second Dimension of Spatial Association","text":"Install use package SecDim example spatial prediction using SDA models. Preparing data Data pre-processing: logarithm transformation removing outliers selecting second dimension variables SDA models SDA modeling comparing FDA  ","code":"## install and library the pacakge install.packages(\"SecDim\") library(\"SecDim\") # spatial data of response variables data(\"obs\") # spatial data of optional SDA explanatory variables: # b = 1, 3, 5, 7, and 9 km # tau = seq(0, 1, 0.1) # eight variables data(\"sample_vars_sda\") obs$y <- obs$Cr_ppm hist(obs$y) obs$y <- log(obs$y) hist(obs$y)  krm <- rmvoutlier(obs$y) y <- obs$y[-krm] x <- lapply(sample_vars_sda, function(x) x[-krm,]) system.time({ # ~2s   sx <- selectvarsda(y, xlist = x) }) data.sda <- cbind(y, sx) sda.lm <- lm(y ~., data.sda) summary(sda.lm) data(\"sample_vars_fda\") data.fda <- data.frame(y, sample_vars_fda[-krm,]) fda.lm <- lm(y ~., data.fda) summary(fda.lm)"},{"path":"https://ausgis.github.io/SecDim/articles/SecDim.html","id":"cross-validation","dir":"Articles","previous_headings":"","what":"Cross validation","title":"`SecDim` Package for The Second Dimension of Spatial Association","text":"     ","code":"## install and library the pacakge install.packages(\"SecDim\") library(\"SecDim\")  R2 <- function(o, p) 1 - sum((o-p)^2)/sum((o-mean(o))^2)  ## Example   # spatial data of response variables data(\"obs\") # spatial data of optional SDA explanatory variables: # b = 1, 3, 5, 7, and 9 km # tau = seq(0, 1, 0.1) # eight variables data(\"sample_vars_sda\")  # data pre-processing: logarithm transformation obs$y <- obs$Cr_ppm hist(obs$y) obs$y <- log(obs$y) hist(obs$y)  ################################################ ## SDA cross validation ################################################  # cross validation: 70% training and 30% testing set.seed(100) train <- sample(nrow(obs), 0.7*nrow(obs), replace = FALSE)  trainy <- obs[train,] testy <- obs[-train,] trainx <- lapply(sample_vars_sda, function(x) x[train,]) testx <- lapply(sample_vars_sda, function(x) x[-train,])  # removing outliers for training data krm <- rmvoutlier(trainy$y) trainy <- trainy$y[-krm] trainx <- lapply(trainx, function(x) x[-krm,])  # generating explanatory variables for testing data sdaxv <- sdapredvars(testx)  # selecting the second dimension variables for SDA models system.time({ # ~1.8s   sx <- selectvarsda(y = trainy, xlist = trainx) })  # SDA modeling and prediction data.sda <- cbind(\"y\" = trainy, sx) sda.lm <- lm(y ~., data.sda) sda.lm.pred <- predict(sda.lm, newdata = sdaxv) R2(testy$y, sda.lm.pred) plot(testy$y, sda.lm.pred, xlim = c(3, 7), ylim = c(3, 7))  ################################################ ## FDA cross validation ################################################ data(\"sample_vars_fda\")  # cross validation: 70% training and 30% testing set.seed(100) train <- sample(nrow(obs), 0.7*nrow(obs), replace = FALSE)  trainy <- obs[train,] testy <- obs[-train,] trainx <- sample_vars_fda[train,] testx <- sample_vars_fda[-train,]  # removing outliers for training data krm <- rmvoutlier(trainy$y) trainy <- trainy$y[-krm] trainx <- trainx[-krm,]  # FDA modeling and prediction data.fda <- data.frame(\"y\" = trainy, trainx) fda.lm <- lm(y ~., data.fda) fda.lm.pred <- predict(fda.lm, newdata = data.frame(testx)) R2(testy$y, fda.lm.pred) plot(testy$y, fda.lm.pred, xlim = c(3, 7), ylim = c(3, 7))"},{"path":"https://ausgis.github.io/SecDim/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Yongze Song. Author, copyright holder. Wenbo Lv. Author, maintainer.","code":""},{"path":"https://ausgis.github.io/SecDim/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Yongze S (2022). “second dimension spatial association.” International Journal Applied Earth Observation Geoinformation, 111, 102834. ISSN 1569-8432, doi:10.1016/j.jag.2022.102834, https://doi.org/10.1016/j.jag.2022.102834.","code":"@Article{Song_2022,   title = {The second dimension of spatial association},   author = {Song Yongze},   year = {2022},   month = {jul},   volume = {111},   pages = {102834},   journal = {International Journal of Applied Earth Observation and Geoinformation},   issn = {1569-8432},   publisher = {Elsevier BV},   doi = {10.1016/j.jag.2022.102834},   url = {https://doi.org/10.1016/j.jag.2022.102834}, }"},{"path":"https://ausgis.github.io/SecDim/index.html","id":"secdim","dir":"","previous_headings":"","what":"SecDim | The Second Dimension of Spatial Association\n","title":"SecDim | The Second Dimension of Spatial Association\n","text":"second dimension spatial association Please cite SecDim : Song, Y. (2022). second dimension spatial association. Journal Applied Earth Observation Geoinformation,111, 102834. https://doi.org/10.1016/j.jag.2022.102834. BibTeX entry LaTeX users :","code":"@Article{Song_2022,     title = {The second dimension of spatial association},     author = {Song Yongze},     year = {2022},     month = {jul},     volume = {111},     pages = {102834},     journal = {International Journal of Applied Earth Observation and Geoinformation},     issn = {1569-8432},     publisher = {Elsevier BV},     doi = {10.1016/j.jag.2022.102834},     url = {https://doi.org/10.1016/j.jag.2022.102834},   }"},{"path":"https://ausgis.github.io/SecDim/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"SecDim | The Second Dimension of Spatial Association\n","text":"Install CRAN : Install development binary version r-universe : Install development source version GitHub :","code":"install.packages(\"SecDim\") install.packages('SecDim',repos = c(\"https://ausgis.r-universe.dev\",                                     \"https://cran.rstudio.com/\")) # install.packages(\"devtools\") devtools::install_github(\"ausgis/SecDim\", build_vignettes = TRUE)"},{"path":"https://ausgis.github.io/SecDim/reference/grids.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatial grid dataset. — grids","title":"Spatial grid dataset. — grids","text":"Spatial datasets explanatory variables 500-m resolution.","code":""},{"path":"https://ausgis.github.io/SecDim/reference/grids.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatial grid dataset. — grids","text":"","code":"grids"},{"path":"https://ausgis.github.io/SecDim/reference/grids.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Spatial grid dataset. — grids","text":"grids: data frame explanatory variables 68757 rows 11 columns.","code":""},{"path":"https://ausgis.github.io/SecDim/reference/grids.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Spatial grid dataset. — grids","text":"Yongze Song yongze.song@curtin.edu.au","code":""},{"path":"https://ausgis.github.io/SecDim/reference/gsdvar.html","id":null,"dir":"Reference","previous_headings":"","what":"Generating second-dimension variables for a spatial variable — gsdvar","title":"Generating second-dimension variables for a spatial variable — gsdvar","text":"Generating second-dimension variables spatial variable","code":""},{"path":"https://ausgis.github.io/SecDim/reference/gsdvar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generating second-dimension variables for a spatial variable — gsdvar","text":"","code":"gsdvar(   pointlocation,   gridlocation,   gridvar,   distbuf = seq(1, 10, 1),   quantileprob = seq(0, 1, 0.1) )"},{"path":"https://ausgis.github.io/SecDim/reference/gsdvar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generating second-dimension variables for a spatial variable — gsdvar","text":"pointlocation matrix data frame point locations gridlocation matrix data frame grid locations gridvar matrix data frame grid variables distbuf vector distance buffer values quantileprob vector quantile probability values","code":""},{"path":"https://ausgis.github.io/SecDim/reference/gsdvar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generating second-dimension variables for a spatial variable — gsdvar","text":"data frame containing selected variables second dimension","code":""},{"path":"https://ausgis.github.io/SecDim/reference/gsdvar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generating second-dimension variables for a spatial variable — gsdvar","text":"","code":"data(obs) data(grids) pointlocation <- obs[sample(nrow(obs), 20), c(\"Lon\", \"Lat\")] gridlocation <- grids[, c(\"Lon\", \"Lat\")] gridvar <- grids$Elevation system.time({ sdavars <- gsdvar(pointlocation, gridlocation, gridvar,                   distbuf = c(1, 2, 3), quantileprob = c(0, 0.5, 1)) }) #>    user  system elapsed  #>   0.390   0.052   0.443"},{"path":"https://ausgis.github.io/SecDim/reference/obs.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatial datasets of trace elements. — obs","title":"Spatial datasets of trace elements. — obs","text":"Spatial datasets trace elements.","code":""},{"path":"https://ausgis.github.io/SecDim/reference/obs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatial datasets of trace elements. — obs","text":"","code":"obs"},{"path":"https://ausgis.github.io/SecDim/reference/obs.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Spatial datasets of trace elements. — obs","text":"obs: data frame trace elements 614 rows 5 variables","code":""},{"path":"https://ausgis.github.io/SecDim/reference/obs.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Spatial datasets of trace elements. — obs","text":"Yongze Song yongze.song@curtin.edu.au","code":""},{"path":"https://ausgis.github.io/SecDim/reference/rmvoutlier.html","id":null,"dir":"Reference","previous_headings":"","what":"Removing outliers. — rmvoutlier","title":"Removing outliers. — rmvoutlier","text":"Function removing outliers.","code":""},{"path":"https://ausgis.github.io/SecDim/reference/rmvoutlier.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Removing outliers. — rmvoutlier","text":"","code":"rmvoutlier(x, coef = 2.5)"},{"path":"https://ausgis.github.io/SecDim/reference/rmvoutlier.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Removing outliers. — rmvoutlier","text":"x vector variable coef number times standard deviation. default value 2.5.","code":""},{"path":"https://ausgis.github.io/SecDim/reference/rmvoutlier.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Removing outliers. — rmvoutlier","text":"Location outliers vector","code":""},{"path":"https://ausgis.github.io/SecDim/reference/rmvoutlier.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Removing outliers. — rmvoutlier","text":"","code":"data(\"obs\") obs$Cr_ppm <- log(obs$Cr_ppm) krm <- rmvoutlier(obs$Cr_ppm) #> Remove 5 outlier(s) krm #> [1]  14  20 185 187 523"},{"path":"https://ausgis.github.io/SecDim/reference/sample_vars_fda.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatial datasets of the first dimension variables of trace elements. — sample_vars_fda","title":"Spatial datasets of the first dimension variables of trace elements. — sample_vars_fda","text":"Spatial datasets first dimension variables trace elements.","code":""},{"path":"https://ausgis.github.io/SecDim/reference/sample_vars_fda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatial datasets of the first dimension variables of trace elements. — sample_vars_fda","text":"","code":"sample_vars_fda"},{"path":"https://ausgis.github.io/SecDim/reference/sample_vars_fda.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Spatial datasets of the first dimension variables of trace elements. — sample_vars_fda","text":"sample_vars_fda: list 8 elements","code":""},{"path":"https://ausgis.github.io/SecDim/reference/sample_vars_fda.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Spatial datasets of the first dimension variables of trace elements. — sample_vars_fda","text":"Yongze Song yongze.song@curtin.edu.au","code":""},{"path":"https://ausgis.github.io/SecDim/reference/sample_vars_sda.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatial datasets of the second dimension variables of trace elements. — sample_vars_sda","title":"Spatial datasets of the second dimension variables of trace elements. — sample_vars_sda","text":"Spatial datasets second dimension variables trace elements.","code":""},{"path":"https://ausgis.github.io/SecDim/reference/sample_vars_sda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatial datasets of the second dimension variables of trace elements. — sample_vars_sda","text":"","code":"sample_vars_sda"},{"path":"https://ausgis.github.io/SecDim/reference/sample_vars_sda.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Spatial datasets of the second dimension variables of trace elements. — sample_vars_sda","text":"sample_vars_sda: list 8 elements","code":""},{"path":"https://ausgis.github.io/SecDim/reference/sample_vars_sda.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Spatial datasets of the second dimension variables of trace elements. — sample_vars_sda","text":"Yongze Song yongze.song@curtin.edu.au","code":""},{"path":"https://ausgis.github.io/SecDim/reference/sdapredvars.html","id":null,"dir":"Reference","previous_headings":"","what":"Preparing explanatory variables data for SDA-based prediction — sdapredvars","title":"Preparing explanatory variables data for SDA-based prediction — sdapredvars","text":"Function preparing explanatory variables data SDA-based prediction testing data cross validation","code":""},{"path":"https://ausgis.github.io/SecDim/reference/sdapredvars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Preparing explanatory variables data for SDA-based prediction — sdapredvars","text":"","code":"sdapredvars(xlist)"},{"path":"https://ausgis.github.io/SecDim/reference/sdapredvars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Preparing explanatory variables data for SDA-based prediction — sdapredvars","text":"xlist list SDA explanatory variables","code":""},{"path":"https://ausgis.github.io/SecDim/reference/sdapredvars.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Preparing explanatory variables data for SDA-based prediction — sdapredvars","text":"data.frame variables prediction validation","code":""},{"path":"https://ausgis.github.io/SecDim/reference/sdapredvars.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Preparing explanatory variables data for SDA-based prediction — sdapredvars","text":"","code":"data(\"obs\") data(\"sample_vars_sda\") obs$Cr_ppm <- log(obs$Cr_ppm) krm <- rmvoutlier(obs$Cr_ppm) #> Remove 5 outlier(s) y <- obs$Cr_ppm[-krm] x <- list(sample_vars_sda[[1]][-krm, 1:11]) kvalidate <- sample(length(y), 0.3*length(y), replace = FALSE) yv <- y[kvalidate] xv <- lapply(x, function(x) x[kvalidate,]) sdaxv <- sdapredvars(xv) sdayxv <- cbind(yv, sdaxv)"},{"path":"https://ausgis.github.io/SecDim/reference/selectvarlm.html","id":null,"dir":"Reference","previous_headings":"","what":"Selecting variables using linear regression — selectvarlm","title":"Selecting variables using linear regression — selectvarlm","text":"Function selecting variables using linear regression","code":""},{"path":"https://ausgis.github.io/SecDim/reference/selectvarlm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Selecting variables using linear regression — selectvarlm","text":"","code":"selectvarlm(y, x, ctr.vif = 10)"},{"path":"https://ausgis.github.io/SecDim/reference/selectvarlm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Selecting variables using linear regression — selectvarlm","text":"y vector response variable x data.frame explanatory variables ctr.vif number VIF threshold","code":""},{"path":"https://ausgis.github.io/SecDim/reference/selectvarlm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Selecting variables using linear regression — selectvarlm","text":"data.frame selected variables","code":""},{"path":"https://ausgis.github.io/SecDim/reference/selectvarlm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Selecting variables using linear regression — selectvarlm","text":"","code":"data(\"obs\") data(\"sample_vars_sda\") obs$Cr_ppm <- log(obs$Cr_ppm) krm <- rmvoutlier(obs$Cr_ppm) #> Remove 5 outlier(s) y <- obs$Cr_ppm[-krm] x <- sample_vars_sda$Elevation[-krm, 1:11] sx <- selectvarlm(y, x)"},{"path":"https://ausgis.github.io/SecDim/reference/selectvarsda.html","id":null,"dir":"Reference","previous_headings":"","what":"Selecting variables for the SDA model — selectvarsda","title":"Selecting variables for the SDA model — selectvarsda","text":"Function selecting variables second dimension spatial association (SDA) model","code":""},{"path":"https://ausgis.github.io/SecDim/reference/selectvarsda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Selecting variables for the SDA model — selectvarsda","text":"","code":"selectvarsda(y, xlist)"},{"path":"https://ausgis.github.io/SecDim/reference/selectvarsda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Selecting variables for the SDA model — selectvarsda","text":"y vector response variable xlist list SDA explanatory variables","code":""},{"path":"https://ausgis.github.io/SecDim/reference/selectvarsda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Selecting variables for the SDA model — selectvarsda","text":"list selected second dimension variables","code":""},{"path":"https://ausgis.github.io/SecDim/reference/selectvarsda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Selecting variables for the SDA model — selectvarsda","text":"","code":"data(\"obs\") data(\"sample_vars_sda\") obs$Cr_ppm <- log(obs$Cr_ppm) krm <- rmvoutlier(obs$Cr_ppm) #> Remove 5 outlier(s) y <- obs$Cr_ppm[-krm] x <- list(sample_vars_sda[[1]][-krm, 1:11]) system.time({ # ~0.01s   sx <- selectvarsda(y, xlist = x) }) #>    user  system elapsed  #>   0.015   0.000   0.016"},{"path":"https://ausgis.github.io/SecDim/reference/vif.html","id":null,"dir":"Reference","previous_headings":"","what":"Fast calculation of the variance inflation factor (VIF) — vif","title":"Fast calculation of the variance inflation factor (VIF) — vif","text":"Function fast calculation variance inflation factor (VIF)","code":""},{"path":"https://ausgis.github.io/SecDim/reference/vif.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fast calculation of the variance inflation factor (VIF) — vif","text":"","code":"vif(x)"},{"path":"https://ausgis.github.io/SecDim/reference/vif.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fast calculation of the variance inflation factor (VIF) — vif","text":"x data.frame explanatory variables","code":""},{"path":"https://ausgis.github.io/SecDim/reference/vif.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fast calculation of the variance inflation factor (VIF) — vif","text":"Variance inflation factor (VIF) values variables","code":""},{"path":"https://ausgis.github.io/SecDim/reference/vif.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fast calculation of the variance inflation factor (VIF) — vif","text":"","code":"data(\"sample_vars_sda\") x <- sample_vars_sda$Elevation[, sample(55, 10)] vif(x) #>  [1] 163.142198 396.453187 154.933169 164.531259  46.833438  40.144002 #>  [7] 224.756892  85.034859 186.270639   3.189894"}]
